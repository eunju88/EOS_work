<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Index</title>
    <!-- 부트 스트랩 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <style>
    #loading {
        width: 100%;  
        height: 100%;  
        top: 0px;
        left: 0px;
        position: fixed;  
        display: block;  
        opacity: 0.7;  
        background-color: #fff;  
        z-index: 9999;  
        text-align: center; 
    } 
        
    #loading-image {  
        position: absolute;  
        top: 25%;  
        left: 35%; 
        z-index:9999;
    }
    </style>
</head>
<body>
    <h1>EOS Wallet</h1>

    <!-- 로그인 하기 버튼 -->
    <form action="/login">
        <button type="submit" class="btn btn-secondary">LOGIN</button>
    </form>
    <hr>
    <!-- 계정 확인 버튼 -->
    <button type="button" id="accountButton" class="btn btn-secondary" data-toggle="modal" data-target="#getacctModal">계정 정보 보기</button>

    <!-- 전송 버튼 -->
    <button type="button" data-toggle="modal" class="btn btn-secondary" data-target="#transferModal">전송하기</button>

    <!-- 히스토리 조회 -->
    <button type="button" class="btn btn-secondary">히스토리</button>

    <div id="history_area">
        <hr>

    </div>

    <!-- 계정 확인 버튼 클릭 시 생성될 modal 화면 -->
    <div class="modal fade" id="getacctModal" tabindex="-1" role="dialog" aria-labelledby="getacctModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"> 계정 정보 </h5>
                    <div class="modal-body">
                        <p>계정 명</p> <input type="text" name="accountName" id="accountName" value="">
                        <p>토큰 잔액</p> <input type="text" name="liquidBalance" id="liquidBalance" value="">
                        <p>CPU</p> <input type="text" name="cpuWeight" id="cpuWeight" value="">
                        <p>NET</p> <input type="text" name="netWeight" id="netWeight" value="">
                    </div>
                </div>
                <div class=modal-footer>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">나가기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 전송 버튼 클릭 시 생성될 modal 화면 -->
    <div class="modal fade" id="transferModal" tabindex="-1" role="dialog" aria-labelledby="transferModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document" style="max-width: 750px; width: 750px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"> Transfer </h5>
                    <div class="modal-body">
                        <form id="transForm">
                        <p>발급처 : <input type="text" name="token" id="token" value="eosio.token"></p> 
                        <p>받을 계정 명 : <input type="text" name="to" id="to" value=""></p> 
                        <p>토큰양 : <input type="text" name="quantity" id="quantity" value=""></p> 
                        <p>메모 : <input type="text" name="memo" id="memo" value=""></p> 
                        <p id="transaction_area"></p>
                        </form>
                    </div>
                </div>
                <div class=modal-footer>
                    <button type="button" id="transferOkButton" class="btn btn-secondary">전송</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">나가기</button>
                </div>
            </div>
        </div>
    </div>

    <div id="loading"><img id="loading-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP8AAADGCAMAAAAqo6adAAAAY1BMVEX////19fU8ouD7+/v4+Pj09PQ2oN/8/fz49/Uyn9/t9vz2+/7b7fn5/f79/v/F4fVKqOKZzO3S6Pd0uuhZruR+v+m93fOi0O92uufK5PWu1vFeseTi8fqQx+vc6vNCpuHs8fWS/O1MAAADt0lEQVR4nO3c23aqMBCAYQUF46HiqdaiW9//KTeoJEGoEip2Tfy/2zYuJpkcCIReDwAAAAAAAAAAAAAAAAAAAAAAAAAAAHhzcRyGg3CQCcP4ry/mxeIs7v5w2LcM3qYSsuD7td6iCn4KvqiCv76+bt2P3vcaiB9Gf64BX3tB2CT6cw389ZV2oVnjX/mXAo0b/8K3UcAxfM/6wMd4VBdivvTLDGp7hk8VsE3+3VRAFnnpP6oT49CfCtgGKi1VQN1Cr7osHL3+SjsxV1Gg1iddAT+Obbc14EcG7I5REJgMuDuy39SAD7PAOM3DD4Lo65wBD0K6WSXIXwfMNiq4iFanUYOMLldA9xfYsXkUFKLNqUmJ0lJB+hCwT3X8kVrMGpWxK2AofAhYmOYPDs3CL1eA7ATYJ6b5V5PGxewxQHICzBZKh5/uHQoO/EiA6bpo/iiYuxSM/UiArcn+jVvJ0IcEGK9086+njmWtHiB2EbQLivjV4sOxbOhBBziY5ncZ/C4G4jvARK99oo1r85cSQGgHWJrJ/9O9dCy+A3yb9B+3KC6+AxyKxY/aNF352kLh8U++dPu3SP9SB3j2pb3EOL22f3RctvoBcxMocgDUi982s19ODwAyb4KnxfAfpW2GP3sAFBn/ss2dr014/Dsz/Lf7gVB2/HMd/6HdDwifAHe/Wf3mpMev+/9Xu/4vPP55cfcbrd5z/H/a/Cdz/t//dv0j/AZwkurNX6e9T034BsBkoyeAVhNgbN6PffalvcTH1jz5bDMBWBtAT7+2l9CPPqPEdfc3J37/Y2r2v77dS8vf/5qY7f+V+wbQQHr693rfegXoPgNYzS80/e0OoDauI6APzz9mZgZ03QG3H4CKnP3PPo86AVK3BPDjAbh5ABqorctNcOhF82cJYB6AHx16gJ39gps/S4C1qQCHR+C+vP9ijwCBarwKtsKXeetrmJsglewanuwpvQHZ8fV1bnpNAJUsR82ONpXCF978mc/zNliUXN7/fhiPPfQJH/yu8heA1bp4//9BRDfnZF5zhd2apEql5u3/ewccbw8ASJ76jXFihX+nBioHQOR3/ovlqXL6p9Ky1eMvMp9614r7FfnRryLAuPYImC+tn6upgHMlXNT+zafwHU+/+hd+7/ZcywM+ngF3OALrw7KnRsMU8PcTCI1GAW+jzz38AIbX0efu5YC/mW+r/QDO8D0+f1MoTv2fn/G+5TegevknsOL8+wfxG4YOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEDFf/UiHVavuqhJAAAAAElFTkSuQmCC" alt="Loading..." /></div>

    <script>
    $(document).ready(function() {
        //getAccount();
        $('#loading').hide();

        $("#accountButton").click(function() {
            getAccount();
        })

        $("#transferOkButton").click(function() {
            transfer();
        })
    })

    function getAccount(){
        $.post('/get_account', function(data){
            //console.log(data);

            var accountName = data.account_name;
            var liquidBalance = data.core_liquid_balance;
            var cpuWeight = data.cpu_weight;
            var netWeight = data.net_weight;

            $("#accountName").val(accountName);
            $("#from").val(accountName);
            $("#liquidBalance").val(liquidBalance);
            $("#cpuWeight").val(cpuWeight);
            $("#netWeight").val(netWeight);
        })
    }

    function transfer(){
        $('#loading').show();
        $.post('/send_transfer', $("#transForm").serialize() ,function(data){
            console.log(data);

            $('#loading').hide();
            if(data){
                if(data.result){
                    $("#transaction_area").html('txt id : '+data.txtid);
                    alert('성공');
                }else{
                    if(data.msg){
                        alert(data.msg);
                    }else{
                        alert('실패');
                    }
                    return;
                }
            }
           
        })
    }
    </script>
</body>
</html>